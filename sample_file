This is main file from terence branch