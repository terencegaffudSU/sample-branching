This is main file from terence branch part 2